<!DOCTYPE html>
<!--
Copyright (C) 2025 twagoo

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<html>

    <body>
        <div th:fragment="facets(facets, query, searchFilters, filterQueryMap)">
            <div th:each="facet: ${facets}"
                 class="facet ms-0 mb-3">
                <h3 class="h4" th:text="#{|facets.labels.${facet.name}|}">Facet name</h3>

                <!-- Facet values -->
                <div th:with="selection=${filterQueryMap[facet.name]}"
                     hx-boost="true" 
                     hx-target="#search-results-and-facets"
                     hx-select="#search-results-and-facets">
                    <!-- Selected values -->
                    <ul th:if="${selection}" class="m-0 p-0" style="list-style: none;">
                        <li th:each="selected : ${filterQueryMap[facet.name]}">
                            [[${selected}]]
                            <a th:href="@{/search(q=${query},fq=${searchFilters},removefq=|${facet.name}:${selected}|)}"><i class="fa-solid fa-xmark"></i></a>
                        </li>
                    </ul>

                    <!-- Unselected values with counts -->
                    <ul class="m-0 p-0" style="list-style: none;">
                        <th:block th:each="facetValue : ${facet.values}">
                            <li th:unless="${selection} and ${#lists.contains(selection, facetValue.value)}"
                                class="p-0 m-0">
                                <a th:href="@{/search(q=${query},fq=${searchFilters},addfq=|${facet.name}:${facetValue.value}|)}">[[${facetValue.value}]]</a>
                                ([[${facetValue.count}]])
                            </li>
                        </th:block>
                    </ul>
                </div>
            </div>
        </div>
    </body>
</html>
